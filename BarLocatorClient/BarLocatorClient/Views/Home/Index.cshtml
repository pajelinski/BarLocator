@{
    ViewBag.Title = "Home Page";
}

<script src="http://maps.google.com/maps/api/js?key=AIzaSyBUVzdLCvCVhgCnU7YO2mb1bHA_N9r0ugc&sensor=true" type="text/javascript"></script>

<div id="map_canvas" style="height: 550px;"></div>

@section scripts {
    <section class="scripts">
        <script type="text/javascript">   
            $(document).ready(function () {
                Initialize();
            });

            function Initialize() {

                google.maps.visualRefresh = true;

                var mapOptions = {
                    zoom: 8,
                    center: { lat: -34.397, lng: 150.644 },
                    mapTypeId: google.maps.MapTypeId.G_NORMAL_MAP
                };

                var infoWindow = new google.maps.InfoWindow({ map: map });

                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(
                        function (position) { setPosition(map, position) },
                        function () {window.handleLocationError(true, infoWindow, map.getCenter());
                    });
                } else {
                    window.handleLocationError(false, infoWindow, map.getCenter());
                }

                var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);
            }

            function setPosition(map, position) {
                var pos = mapLocaliztion(position);

                setBlueMarker(map, pos, "Your location");
                map.setCenter(pos);
            }

            function setBlueMarker(map, position, title) {
                var marker = setMarker(map, position, title);
                marker.setIcon('http://maps.google.com/mapfiles/ms/icons/blue-dot.png');
            }

            function setMarker(map, position, title) {
                return new google.maps.Marker({
                    'position': position,
                    'map': map,
                    'title': title
                });
            }

            function mapLocaliztion(position) {
                return {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };
            }

        </script>
    </section>
}